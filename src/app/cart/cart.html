<div class="container mx-auto px-4 py-6">
	<h1 class="text-2xl font-bold text-gray-900 mb-4">Your Cart</h1>

	<!-- Loading State -->
	<div *ngIf="isLoading" class="flex justify-center items-center py-12">
		<div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600"></div>
	</div>

	<!-- Error Message -->
	<div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
		<span class="block sm:inline">{{ error }}</span>
	</div>

	<div *ngIf="!isLoading && cartItems?.length; else empty" class="grid lg:grid-cols-3 gap-6">
		<!-- Items list -->
		<div class="lg:col-span-2 space-y-4">
			<div *ngFor="let item of cartItems" class="bg-white rounded-lg shadow-md p-4 flex items-start gap-4">
				<img [src]="item.image" [alt]="item.name" class="w-28 h-28 object-cover rounded-md" />

				<div class="flex-1">
					<h3 class="text-lg font-semibold text-gray-900">{{ item.name }}</h3>
					<p class="text-gray-600 text-sm mt-1">{{ item.description }}</p>

					<div class="mt-3 flex items-center gap-4">
						<div class="flex items-center border rounded-md overflow-hidden">
							<button (click)="decrease(item)" class="px-3 py-1 bg-gray-100 hover:bg-gray-200">-</button>
							<div class="px-4 text-sm">{{ item.qty }}</div>
							<button (click)="increase(item)" class="px-3 py-1 bg-gray-100 hover:bg-gray-200">+</button>
						</div>

						<div class="text-lg font-bold text-gray-900">${{ (item.price * item.qty) | number:'1.2-2' }}</div>

						<button (click)="remove(item)" class="ml-auto text-red-500 hover:text-red-700">Remove</button>
					</div>
				</div>
			</div>
		</div>

		<!-- Summary -->
		<aside class="bg-white rounded-lg shadow-md p-6 h-fit">
			<h2 class="text-lg font-semibold mb-4">Order Summary</h2>

			<div class="flex justify-between text-gray-600">
				<span>Items</span>
				<span>{{ getItemsCount() }}</span>
			</div>

			<div class="flex justify-between text-gray-600 mt-2">
				<span>Subtotal</span>
				<span class="font-bold text-gray-900">${{ total | number:'1.2-2' }}</span>
			</div>

			<div class="mt-4">
				<button 
					(click)="checkout()" 
					[disabled]="isCheckingOut"
					class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-300 text-white px-4 py-2 rounded-lg transition relative">
					<span [class.invisible]="isCheckingOut">Checkout</span>
					<div *ngIf="isCheckingOut" class="absolute inset-0 flex items-center justify-center">
						<div class="animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"></div>
					</div>
				</button>
			</div>
		</aside>
	</div>

	<ng-template #empty>
		<div class="bg-white rounded-lg shadow-md p-8 text-center">
			<p class="text-gray-700 text-lg mb-4">Your cart is empty.</p>
			<a routerLink="/shop" class="inline-block bg-amber-500 hover:bg-amber-600 text-white px-4 py-2 rounded-lg">Continue Shopping</a>
		</div>
	</ng-template>
</div>